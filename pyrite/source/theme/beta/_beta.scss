@use "backend" as *;
/* Begin Beta Branch */
// Expect it to not work fully.
html[lang="en-GB"],
html[lang="fr"] {
	//test colors lol
	// --green-color: green;
	// --yellow-color: yellow;
	// --red-color: red;
	// --link-color: cyan;
	// --offline-color: white;
}
// HOLY SHIT FUCK SAKE
// this stuff is basically thrown together real quick,
// don't expect it to last forever.
#{c(main visualRefresh)} {
	// VARIABLE FIXING
	&#{c(main light)},
	&#{c(main dark)},
	&#{c(main darker)},
	&#{c(main midnight)},
	#{c(main light)},
	#{c(main dark)},
	#{c(main darker)},
	#{c(main midnight)} {
		--input-background: var(--card-background);
		--modal-background: var(--card-background);
		--modal-footer-background: transparent;
		--text-positive: var(--green-color);
		--text-warning: var(--yellow-color);
		--scrollbar-auto-scrollbar-color-thumb: var(--primary-color);
		--scrollbar-auto-scrollbar-color-track: transparent;
		--scrollbar-auto-thumb: var(--primary-color);
		--scrollbar-auto-track: transparent;
		--scrollbar-thin-thumb: var(--primary-color);
		--background-message-hover: transparent;
		--background-mentioned: rgb(from var(--mention-background) r g b/var(--mention-opacity));
		--background-mentioned-hover: rgb(from var(--mention-background) r g b/calc(0.2 + var(--mention-opacity)));
	}
	:is(
		// ensure transparency in theme
		#{c(main appMount)},
		body,
		#{c(main bg)},
		// server list
		#{c(serverList wrapper)},
		// sidebar channel list
		#{c(sidebar list)},
		// sidebar list
		#{c(sidebar private channels)},
		// server header
		#{c(sidebar server header header)},
		// channel user limit
		#{c(sidebar server channel voiceLimitUsers)},
		#{c(sidebar server channel voiceLimitTotal)},
		// friends page
		#{c(friends tabBody)},
		// chat is this real
		#{c(chat)},
		// replying to message bar
		#{c(chatForm stackedBars)},
		// settings
		#{c(userSettings standardSidebarView)},
		// loading chat
		#{c(chat chatLoadingWrapper)},
		// loading message
		#{c(chat messageLoadingWrapper)},
		// chat button wrapper
		#{c(chat buttonWrapper)},
		// threads chat
		#{c(threads container)},
		// threads resize handle
		#{c(threads resizeHandle)},
		// threads top bar / header thing
		#{c(forums open topBar container)},
		// embeded text file footer
		#{c(embeds textFooter)},
		// server voice channel side chat
		#{c(call channelChatWrapper)}
	) {
		background: transparent;
	}
	// extra transparent stuff
	#{c(sidebar server header hasBanner)} #{c(sidebar server header header)} {
		background: transparent;
	}
	// and card stuff
	:is(
		// voice limit
		#{c(sidebar server channel voiceLimitWrapper)},
		// chat divider
		#{c(chat dividerContent)},
		// embeds
		#{c(embeds embedFull)},
		// poll
		#{c(embeds poll container)},
		// active now card
		#{c(friends itemCardOuter)},
		// finished poll card
		#{c(embeds poll finished container)},
		// right click menu
		#{c(modals menus menu)},
		// forums search / create post box
		#{c(forums mainCard)},
		// forums guidelines
		#{c(forums guidelines container)}
	) {
		background: $card;
	}
	// and middle stuff
	:is(
		// chat is this real
		#{c(chat chatContentInner)},
		// settings middle
		#{c(userSettings contentRegionScroller)},
		// voice channel call middle thing
		#{c(call root)}
	) {
		background: $middle;
	}
	// and header stuff
	:is(
		// top bar thing
		#{c(topBar bar)},
		// server header
		#{c(sidebar server header clickable)},
		// private channel header
		#{c(sidebar private searchBar)}
	) {
		background: $header;
	}
	// and side stuff
	:is(
		// sidebar panel
		#{c(sidebar panel panels)},
		// sidebar server
		#{c(sidebar server scroller)},
		// private channels scrollbar
		#{c(sidebar private scroller)},
		// settings side
		#{c(userSettings sidebarRegionScroller)}
	) {
		background: $side;
	}

	// some things are different...

	// themed header
	#{c(header)}#{c(header themed)} {
		background: $header;
	}

	// remove borders
	:is(
		// sidebar channel list
		#{c(sidebar list)},
		// private searchbar
		#{c(sidebar private searchBar)},
		// sidebar panel
		#{c(sidebar panel panels)},
		// sidebar panel buttons
		#{c(sidebar panel buttons buttons)},
		// voice channel limit
		#{c(sidebar server channel voiceLimitWrapper)},
		// friends page container
		#{c(friends container)},
		// server header
		#{c(sidebar server header header)},
		// header bar
		#{c(header)},
		// threads chat (it has top and left)
		#{c(threads container)},
		// call container (it has top and right)
		#{c(call container)}
	) {
		border: none;
	}
	// remove borders (extra)
	#{c(sidebar server header hasBanner)} #{c(sidebar server header header)},
	#{c(chat)}[data-has-border=true] {
		border: none;
	}
	#{c(messageRequests container)} {
		border-top: none;
	}

	// add back borders
	// :is(
	// ) {
	// 	border-color: $primary;
	// }
	:is(
		// poll container
		#{c(embeds poll container)},
		// forums search / create post box
		#{c(forums mainCard)},
		// forums guidelines
		#{c(forums guidelines container)}
	) {
		border-color: $secondary;
	}

	// border radius == 0
	:is(
		// sidebar channel list
		#{c(sidebar list)},
		// panel
		#{c(sidebar panel panels)}
	) {
		border-radius: 0;
	}

	// remove help button
	#{c(topBar trailing container)} #{c(main anchorLink)}[href="https://support.discord.com"] {
		display: none;
	}
	// windows stuff
	&#{c(os win)} {
		// fix server list
		#{c(serverList servers)} {
			&::after {
				content: none;
			}
		}
		// window buttons aren't there anymore
		#{c(header toolbar)} {
			padding-right: unset;
			margin-right: unset;
		}
	}
	// linux/web stuff
	&:is(
		#{c(os linux)},
		#{c(os web)}
	) {
		// ::before and ::after
		#{c(serverList servers)} {
			&::after {
				content: none;
			}
			// @include bg($bg:$header,$h:48px);
		}
		// list
		#{c(serverList tree)} {
			height: calc(100% - 48px);
		}
	}
	// dms scroller margin
	#{c(sidebar private scroller)},
	// server list margin
	#{c(serverList wrapper)} {
		margin-bottom: var(--custom-app-panels-height,0);
	}
	// channel list margins
	#{c(sidebar server scroller)} {
		margin-bottom: 0;
		margin-right: 0;
	}
	// private searchbar
	#{c(sidebar private searchBar)} {
		box-sizing: content-box; // revert border-box
		// remove that fucking button colour
		#{c(button lookFilled)}#{c(button colorPrimary)} {
			background: transparent;
			&::before {
				content: none;
			}
		}
	}
	// sidebar panel buttons
	#{c(sidebar panel buttons buttons)} {
		gap: 0;
	}
	// remove backgrounds
	#{c(sidebar)} {
		&::before,
		&::after {
			content: none;
		}
	}
	// panels
	#{c(sidebar panel panels)} {
		left: 0;
		bottom: 0;
		width: 100%;
		box-shadow: none;
	}
	// server header
	#{c(sidebar server header header)} {
		border-radius: 0;
	}
	// channel stuff
	#{c(sidebar server channel modeUnreadImportant)} #{c(sidebar server channel icon)} {
		color: inherit;
	}
	// add friend header bar button
	#{c(header tabBar)} #{c(header tabBarItem)}#{c(header addFriend)}#{c(header addFriend)}#{c(header addFriend)} {
		&:hover {
			background: $hover;
		}
		&[aria-selected=true] {
			background: rgb(from $primary r g b / 0.2);
			color: $primary;
		}
	}
	// chat input
	#{c(chatForm channelTextAreaMain)} {
		background: rgb(255 255 255 / .05);
	}
}

// CHATBOX REFRESH
#{c(main visualRefreshChatInput)} {
	// move backdrop filter to different element
	#{c(chatForm scrollableContainer)} {
		backdrop-filter: none;
	}

	#{c(chatForm channelTextAreaMain)} {
		backdrop-filter: blur(2px);
	}
}

// TODO WITH THE REFRESH:
// Move inbox button down into header bar
// Fix notices
// a whole host of other unthemed areas